# ---------- Initialize Simulation --------------------- 
clear 
units metal 
dimension 3 
boundary p p p 
atom_style atomic 
#atom_modify map array

#---------------SIMULATION CELL-----------
region whole block -10 10 -10 10 -10 10 units box
create_box 6 whole

# ---------- ATOM DEFINITIONS --------------------- 
region box block -10 10 -10 10 -10 10 units box
lattice bcc 3.08 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
create_atoms 1 region box  # Start with type 1 atoms


set type 1 type/fraction 1 1.0 12345 # Al (100%)
set type 1 type/fraction 2 0.90 12345 # Cr (8.333% of remaining 91.667%)
set type 2 type/fraction 3 0.50 12345 # Fe(16.667% of remaining 83.333%)
set type 3 type/fraction 4 0.30 12345 # Co (8.333% of remaining 66.667%)
set type 4 type/fraction 5 0.20 12345 # Ni (25.000% of remaining 58.333%)
set type 5 type/fraction 6 0.10 12345 # Cu (16.667% of remaining 33.333%)

# ---------- Define Interatomic Potential --------------------- 
pair_style lj/cut 10
pair_coeff 1 1 0.63 3.8  
pair_coeff 2 2 0.15 2.6
pair_coeff 3 3 0.1 2.5
pair_coeff 4 4 0.18 2.7
pair_coeff 5 5 0.2 2.8
pair_coeff 6 6 0.41 2.55


# ---------MASSES ------------
mass 1 26.9815
mass 2 51.996
mass 3 55.845
mass 4 58.933
mass 5 58.693
mass 6 63.546
 
# ---------- Define Settings --------------------- 
compute eng all pe/atom 
compute eatoms all reduce sum c_eng 

# ---------- Run Energy Minimization --------------------- 
reset_timestep 0 
fix 1 all box/relax iso 0.0 vmax 0.001
thermo 10 
thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms 

min_style cg 
minimize 1e-25 1e-25 5000 10000 

# ---------- Prepare for MSAD Calculation --------------------- 
unfix 1  # Remove minimization fix
velocity all create 1.0 1234567 mom yes rot yes dist gaussian  # Assign initial velocities
fix nvt all nvt temp 1.0 298.0 100.0  # Apply NVT thermostat to maintain 300K

# ---------- Compute MSAD --------------------- 
compute msad all msd  # Track mean squared atomic displacement
fix msad_output all ave/time 100 1 100 c_msad file msd_output.txt mode vector  # Store MSAD data

# ---------- Run Simulation for MSAD Tracking --------------------- 
run 50000  # Run for 50,000 timesteps to track atomic displacements

# ---------- Export Final Data --------------------- 
write_data structure_msad.lmpdat nocoeff  # Save relaxed structure