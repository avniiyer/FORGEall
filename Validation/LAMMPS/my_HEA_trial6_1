# ---------- Initialize Simulation --------------------- 
clear 
units metal 
dimension 3 
boundary p p p 
atom_style atomic 
#atom_modify map array

#---------------SIMULATION CELL-----------
region whole block -10 10 -10 10 -10 10 units box
create_box 6 whole

# ---------- ATOM DEFINITIONS --------------------- 
region box block -10 10 -10 10 -10 10 units box
lattice bcc 3.08 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
create_atoms 1 region box  # Start with type 1 atoms


set type 1 type/fraction 1 1.0 12345 # Al (100%)
set type 1 type/fraction 2 0.90 12345 # Cr (8.333% of remaining 91.667%)
set type 2 type/fraction 3 0.50 12345 # Fe(16.667% of remaining 83.333%)
set type 3 type/fraction 4 0.30 12345 # Co (8.333% of remaining 66.667%)
set type 4 type/fraction 5 0.20 12345 # Ni (25.000% of remaining 58.333%)
set type 5 type/fraction 6 0.10 12345 # Cu (16.667% of remaining 33.333%)



# Define groups for each atom type
group Al type 1
group Cr type 2
group Fe type 3
group Co type 4
group Ni type 5
group Cu type 6




# Store group counts in variables
variable Al_count equal count(Al)
variable Cr_count equal count(Cr)
variable Fe_count equal count(Fe)
variable Co_count equal count(Co)
variable Ni_count equal count(Ni)
variable Cu_count equal count(Cu)



# Print the number of atoms in each group
print "Number of Al atoms: ${Al_count}"
print "Number of Cr atoms: ${Cr_count}"
print "Number of Fe atoms: ${Fe_count}"
print "Number of Co atoms: ${Co_count}"
print "Number of Ni atoms: ${Ni_count}"
print "Number of Cu atoms: ${Cu_count}"



# ---------- Define Interatomic Potential --------------------- 
pair_style lj/cut 10
pair_coeff 2 2 0.63 3.8  
pair_coeff 3 3 0.15 2.6
pair_coeff 5 5 0.1 2.5
pair_coeff 6 6 0.18 2.7
pair_coeff 7 7 0.2 2.8
pair_coeff 8 8 0.41 2.55

# ---------MASSES ------------
mass 1 26.9815
mass 2 51.996
mass 3 55.845
mass 4 58.933
mass 5 58.693
mass 6 63.546


 
# ---------- Define Settings --------------------- 
compute eng all pe/atom 
compute eatoms all reduce sum c_eng 

# ---------- Run Energy Minimization --------------------- 
reset_timestep 0 
fix 1 all box/relax iso 0.0 vmax 0.001
thermo 10 
thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms 

min_style cg 
minimize 1e-25 1e-25 5000 10000 

unfix 1  # âœ… UNFIX MINIMIZATION BEFORE STRAIN

variable Lz0 equal lz
print "Intiial length: ${Lz0}"
variable Lz0 equal 39.1572351796934


# ----------------- 5. Initialize Velocities -----------------
velocity all create 300.0 1234567 mom yes rot yes dist gaussian

# ----------------- 6. Apply Thermostat -----------------
fix nvt all nvt temp 300.0 300.0 100.0

# ----------------- 7. Apply Deformation (Strain) -----------------
variable strain_rate equal 1.0e-2
fix deform all deform 1 z erate ${strain_rate} units box remap x

# ----------------- 8. Compute Stress & Strain -----------------
compute peratom_stress all stress/atom NULL
compute stress_tensor all reduce sum c_peratom_stress[3]
variable stress equal "c_stress_tensor / vol"

variable strain equal "(lz - v_Lz0) / v_Lz0"

variable current_Lz equal lz


# ----------------- 9. Output Stress-Strain Data -----------------
thermo_style custom step v_strain v_stress press pzz
thermo 3000
fix output all print 3000 "${strain} ${stress}" file my_hea_stress_strain.txt screen no

# ----------------- 10. Run Simulation -----------------
timestep 0.001
run 100000

# ----------------- 11. Save Final Configuration -----------------
write_data my_stressed_HEA.lmp
write_dump all custom my_stressed_HEA.dump id type x y z